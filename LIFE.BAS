1 DEFINT A
2 DEFINT B
3 DEFINT R
4 DEFINT C
5 DEFINT Z
6 DEFINT S
7 DEFINT T
10 INPUT "ROWS> " R
11 INPUT "COLS> " C
12 INPUT "# OF GENERATIONS> " T
40 DIM A(R, C)
50 DIM B(R, C)
60 REM SUM
70 LET S=0
80 DIM Z(8)
90 REM
100 REM NUMBER OF TICKS/GENERATIONS
110 REM
120 REM
130 REM SEED THE BOARD
131 FOR I=1 TO R
132 INPUT "ENTER ROW ";I;" WITH ";C;" DIGITS" J$
133 FOR H=1 TO C
134 IF MID$(J$,H,1) = "0" THEN A(I,H) = 0 : GOTO 138
135 A(I,H) = 1
138 NEXT H
139 NEXT I
140 REM A(1,1)=0:A(1,2)=0:A(1,3)=0:A(1,4)=0
141 REM A(1,5)=0:A(1,6)=0:A(1,7)=0:A(1,8)=0
150 REM A(2,1)=0:A(2,2)=1:A(2,3)=0:A(2,4)=0
151 REM A(2,5)=0:A(2,6)=0:A(2,7)=0:A(2,8)=0
160 REM A(3,1)=0:A(3,2)=1:A(3,3)=1:A(3,4)=1
161 REM A(3,5)=0:A(3,6)=0:A(3,7)=0:A(3,8)=1
170 REM A(4,1)=0:A(4,2)=0:A(4,3)=0:A(4,4)=1
171 REM A(4,5)=0:A(4,6)=0:A(4,7)=0:A(4,8)=1
180 REM A(5,1)=1:A(5,2)=0:A(5,3)=0:A(5,4)=0
181 REM A(5,5)=0:A(5,6)=0:A(5,7)=1:A(5,8)=1
190 REM A(6,1)=0:A(6,2)=0:A(6,3)=0:A(6,4)=0
191 REM A(6,5)=0:A(6,6)=0:A(6,7)=0:A(6,8)=0
200 REM A(7,1)=0:A(7,2)=0:A(7,3)=0:A(7,4)=0
201 REM A(7,5)=0:A(7,6)=0:A(7,7)=0:A(7,8)=0
210 REM A(8,1)=0:A(8,2)=0:A(8,3)=0:A(8,4)=0
211 REM A(8,5)=0:A(8,6)=0:A(8,7)=0:A(8,8)=0
220 REM
230 REM PLAY THE BOARD
240 FOR N=1 TO T
250 GOSUB 300
260 NEXT N
270 GOTO 9000
280 REM
290 REM TICK
300 FOR I = 1 TO R
310 FOR J = 1 TO C
320 REM
330 GOSUB 1000
340 GOSUB 2000
350 GOSUB 3000
360 GOSUB 4000
370 GOSUB 5000
380 GOSUB 6000
390 GOSUB 7000
400 GOSUB 8000
410 REM
420 S=Z(1)+Z(2)+Z(3)+Z(4)
421 S=S+Z(5)+Z(6)+Z(7)+Z(8)
430 IF S < 2 THEN B(I, J) = 0 : GOTO 470
440 IF S > 3 THEN B(I, J) = 0 : GOTO 470
450 IF S = 3 THEN B(I, J) = 1 : GOTO 470
460 IF S = 2 THEN B(I, J) = A(I, J)
470 NEXT J
480 NEXT I
490 REM
500 REM COPY NEW BOARD OVER
510 FOR I = 1 TO R
520 FOR J = 1 TO C
530 A(I, J) = B(I, J)
540 NEXT J
550 NEXT I
560 REM
570 REM PRINT THE BOARD
579 PRINT "=== GENERATION "; N; " ==="
580 FOR I = 1 TO R
581 FOR J = 1 TO C
590 PR A(I,J);
598 NEXT J
599 PR " "
600 NEXT I
610 RETURN
620 REM
1000 IF I-1 < 1 THEN Z(1) = 0 : GOTO 1030
1010 IF J-1 < 1 THEN Z(1) = 0 : GOTO 1030
1020 IF I-1 > 0 THEN IF J-1 > 0 THEN Z(1) = A(I-1, J-1)
1030 RETURN
2000 IF I-1 < 1 THEN Z(2) = 0 : GOTO 2020
2010 IF I-1 > 0 THEN Z(2) = A(I-1, J)
2020 RETURN
3000 IF I-1 < 1 THEN Z(3) = 0 : GOTO 3030
3010 IF J+1 > C THEN Z(3) = 0 : GOTO 3030
3020 IF I-1 > 0 THEN IF J+1 <= C THEN Z(3) = A(I-1, J+1)
3030 RETURN
4000 IF J+1 > C THEN Z(4) = 0 : GOTO 4020
4010 IF J+1 <= C THEN Z(4) = A(I, J+1)
4020 RETURN
5000 IF I+1 > R THEN Z(5) = 0 : GOTO 5030
5010 IF J+1 > C THEN Z(5) = 0 : GOTO 5030
5020 IF I+1 <= R THEN IF J+1 <= C THEN Z(5) = A(I+1, J+1)
5030 RETURN
6000 IF I+1 > R THEN Z(6) = 0 : GOTO 6020
6010 IF I+1 <= R THEN Z(6) = A(I+1, J)
6020 RETURN
7000 IF I+1 > R THEN Z(7) = 0 : GOTO 7030
7010 IF J-1 < 1 THEN Z(7) = 0 : GOTO 7030
7020 IF I+1 <= R THEN IF J-1 > 0 THEN Z(7) = A(I+1, J-1)
7030 RETURN
8000 IF J-1 < 1 THEN Z(8) = 0 : GOTO 8020
8010 IF J-1 > 0 THEN Z(8) = A(I, J-1)
8020 RETURN
9000 PRINT "DONE"
